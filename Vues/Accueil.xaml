<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AP4DantecMarket.Vues.VueAccueil"
             BackgroundColor="#1A1A1A"
             Padding="15">

    <ScrollView>
        <VerticalStackLayout HorizontalOptions="Fill" VerticalOptions="Fill" Spacing="20">
            <!-- Logo et email utilisateur -->
            <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="15">
                <Image Source="logo.png"
                       HeightRequest="100"
                       HorizontalOptions="Center"
                       Margin="0,10,0,5"/>
                <Label x:Name="UserEmailLabel"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="#FFD700"
                       HorizontalOptions="Center"/>
            </VerticalStackLayout>

            <!-- Carrousel amÃ©liorÃ© -->
            <Frame Padding="10"
                   BackgroundColor="#2E2E30"
                   BorderColor="#FFD700"
                   CornerRadius="15"
                   HasShadow="True"
                   HorizontalOptions="Fill"
                   Margin="10">
                <CarouselView x:Name="MessageCarousel"
                              HeightRequest="60"
                              Loop="True"
                              IsSwipeEnabled="True"
                              HorizontalOptions="Fill">
                    <CarouselView.ItemsSource>
                        <x:Array Type="{x:Type x:String}">
                            <x:String>Bienvenue sur Dantec Market !</x:String>
                            <x:String>DÃ©couvrez nos offres exclusives</x:String>
                            <x:String>Profitez de nos promotions !</x:String>
                        </x:Array>
                    </CarouselView.ItemsSource>
                    <CarouselView.ItemTemplate>
                        <DataTemplate>
                            <Label Text="{Binding}"
                                   FontSize="18"
                                   FontAttributes="Bold"
                                   TextColor="White"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   Padding="10"/>
                        </DataTemplate>
                    </CarouselView.ItemTemplate>
                </CarouselView>
            </Frame>

            <!-- Grille de boutons optimisÃ©e -->
            <Grid RowDefinitions="Auto, Auto" ColumnDefinitions="*,*" RowSpacing="15" ColumnSpacing="15" HorizontalOptions="Fill" Padding="10">
                <Button Text="ðŸ” Rechercher"
                        x:Name="ButtonRechercher"
                        Clicked="OnVoirProduitsClicked"
                        BackgroundColor="#FFD700"
                        TextColor="Black"
                        FontAttributes="Bold"
                        CornerRadius="25"
                        HeightRequest="70"
                        Grid.Row="0" Grid.Column="0"/>

                <Button Text="ðŸ“‚ CatÃ©gories"
                        x:Name="ButtonCategories"
                        Clicked="OnVoirCategorieClicked"
                        BackgroundColor="#FFD700"
                        TextColor="Black"
                        FontAttributes="Bold"
                        CornerRadius="25"
                        HeightRequest="70"
                        Grid.Row="0" Grid.Column="1"/>

                <Button Text="ðŸ›’ Panier"
                        x:Name="ButtonPanier"
                        Clicked="OnVoirPanierClicked"
                        BackgroundColor="#FFD700"
                        TextColor="Black"
                        FontAttributes="Bold"
                        CornerRadius="25"
                        HeightRequest="70"
                        Grid.Row="1" Grid.Column="0"/>

                <Button Text="ðŸ“¦ Commandes"
                        x:Name="ButtonCommandes"
                        Clicked="AllerCommandes"
                        BackgroundColor="#FFD700"
                        TextColor="Black"
                        FontAttributes="Bold"
                        CornerRadius="25"
                        HeightRequest="70"
                        Grid.Row="1" Grid.Column="1"/>
            </Grid>

            <!-- Bouton Favoris -->
            <Button Text="â­ Favoris"
                    x:Name="ButtonFavoris"
                    Clicked="OnVoirFavorisClicked"
                    BackgroundColor="#FFD700"
                    TextColor="Black"
                    FontAttributes="Bold"
                    CornerRadius="25"
                    HeightRequest="70"
                    HorizontalOptions="Fill"/>

            <!-- Section des promotions -->
            <Frame Padding="10"
                   BackgroundColor="#2E2E30"
                   BorderColor="#FFD700"
                   CornerRadius="15"
                   HasShadow="True"
                   HorizontalOptions="Fill"
                   Margin="10">
                <CollectionView ItemsSource="{Binding Promotions}" 
                ItemsLayout="VerticalList">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Margin="10"
                   Padding="10"
                   BorderColor="Gray"
                   CornerRadius="10"
                   HasShadow="True">
                                <StackLayout Spacing="8">
                                    <!-- Titre de la promotion -->
                                    <Label Text="{Binding Titre}" 
                           FontAttributes="Bold"
                           FontSize="Medium"
                           TextColor="Black"
                           LineBreakMode="TailTruncation" />

                                    <!-- Date de la promotion -->
                                    <Label Text="{Binding DateDebut, StringFormat='Valable du {0:d}'}"
FontSize="14"
TextColor="LightGray"/>

                                    <!-- Bouton vers la page produit -->
                                    <Button Text="Voir Offre"
                            BackgroundColor="Gold"
                            TextColor="Black"
                            CornerRadius="8"
                            HorizontalOptions="FillAndExpand"
                            Clicked="OnPromoClicked" />
                                </StackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
                <ScrollView Orientation="Horizontal">
                    <HorizontalStackLayout Spacing="10">
                        <CollectionView x:Name="PromotionListView"
               ItemsSource="{Binding Promotions}"
                ItemsLayout="VerticalList"
                VerticalOptions="FillAndExpand"   
                            HorizontalOptions="FillAndExpand"
                           
                            Margin="0,0,0,15">

                            <CollectionView.ItemTemplate>
                        <DataTemplate>
                                    <Frame Padding="10"
       Margin="0, 0, 0, 0" 
                                        BackgroundColor="#2E2E30"
       BorderColor="#FFD700"
       CornerRadius="15"
       HasShadow="True"
       HorizontalOptions="Fill">



                                        <HorizontalStackLayout Spacing="10">
                                            <Frame Padding="5"
       HasShadow="True"
       BackgroundColor="Transparent"
       CornerRadius="10"
       WidthRequest="100">
                                                <Image Source="{Binding Produit.LesImages[0].FullUrl}"
           Aspect="AspectFit"   
                                                    HeightRequest="90"
                                                  
                                                    WidthRequest="90"/>
                                                   
                                            </Frame>



                                            <!-- DÃ©tails de la promotion -->
                                    <VerticalStackLayout VerticalOptions="CenterAndExpand" Spacing="5" HorizontalOptions="FillAndExpand">


                                        <Label Text="{Binding Produit.NomProduit}" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="White"
                               LineBreakMode="WordWrap"/>

                                        <Label Text="{Binding DateDebut}"
                               FontSize="14"
                               TextColor="LightGray"/>

                                        <HorizontalStackLayout>
                                            <Label Text="{Binding Produit.Prix, StringFormat='Prix : {0:C}'}" TextColor="Red"/>
                                            <Label Text="{Binding PrixPromo, StringFormat='Promo : {0:C}'}" TextColor="Green"/>
                                        </HorizontalStackLayout>
                                        <Button Text="Voir Offre"
        BackgroundColor="Gold"
        TextColor="Black"
        CornerRadius="10"
        HeightRequest="40"
        HorizontalOptions="Center"
        Clicked="OnPromoClicked" />


                                    </VerticalStackLayout>

                                </HorizontalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
                    </HorizontalStackLayout>
                </ScrollView>

            </Frame>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
